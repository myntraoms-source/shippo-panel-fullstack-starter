services:
  - type: web
    name: shippo-backend
    env: node
    buildCommand: "cd backend && npm install"
    startCommand: "cd backend && npm run start"
    envVars:
      - key: SHIPPO_API_TOKEN
        sync: false
      - key: MARKUP_PERCENT
        value: "5"
      - key: RAZORPAY_KEY_ID
        sync: false
      - key: RAZORPAY_KEY_SECRET
        sync: false
      - key: RAZORPAY_WEBHOOK_SECRET
        sync: false
      - key: FX_CACHE_TTL
        value: "600"
      - key: PORT
        value: "8080"

  - type: web
    name: shippo-frontend
    env: static
    buildCommand: "cd frontend && npm install && npm run build"
    staticPublishPath: "frontend/dist"
    routes:
      - type: rewrite
        source: /api/*
        destination: https://shippo-backend.onrender.com/*
